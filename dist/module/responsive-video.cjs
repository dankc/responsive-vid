"use strict";var p=Object.defineProperty;var h=(s,e,t)=>e in s?p(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var i=(s,e,t)=>h(s,typeof e!="symbol"?e+"":e,t);Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const E=["mp4","webm","ogg","x-m4v","quicktime","x-ms-wmv","mpeg","3gpp","3gpp2"];function m(){return Array.from(document.querySelectorAll("video[data-responsive-video]"))}function f(s){const e=s.split("."),t=e[e.length-1];return E.includes(t)?`video/${t}`:void 0}function y(s){return s=/^\(/.test(s)?s:`(${s}`,/\)$/.test(s)?s:`${s})`}function g(){m().forEach(e=>{const t=JSON.parse(e.dataset.responsiveVideo);new v({el:e,options:t})})}class v{constructor({el:e,options:t}){i(this,"videoEl");i(this,"options");i(this,"breakpoints");i(this,"isPaused");i(this,"playListener",()=>{this.isPaused=!1});i(this,"pauseListener",()=>{this.isPaused=!0});if(!Object.keys(t).length)throw Error("No options provided to responsive-video.js");if(typeof e=="string"||e.nodeName!=="VIDEO")throw Error('Invalid "el" provided to responsive-video.js');this.videoEl=e,this.options=t,this.breakpoints=Object.keys(t),this.isPaused=this.videoEl.paused,this.init()}init(){this.videoEl.addEventListener("pause",this.pauseListener),this.videoEl.addEventListener("play",this.playListener),this.breakpoints.forEach(e=>{const t=y(e),o=window.matchMedia(t);o.matches&&this.addVideo(e),o.addEventListener("change",({matches:d})=>{d&&this.addVideo(e)})})}addVideo(e){var l;const t=this.videoEl.currentTime,{src:o,poster:d}=this.options[e],u=Array.isArray(o)?[...o]:[o],a=()=>{this.videoEl.currentTime=t<this.videoEl.duration?t:0,this.isPaused===!1&&this.videoEl.play(),this.videoEl.removeEventListener("loadedmetadata",a)};d&&this.videoEl.setAttribute("poster",d),(l=this.videoEl.querySelectorAll("source"))==null||l.forEach(r=>{r.remove()}),u.forEach(r=>{const n=document.createElement("source"),c=f(r);n.setAttribute("src",r),c?n.setAttribute("type",c):n.removeAttribute("type"),this.videoEl.appendChild(n)}),this.videoEl.addEventListener("loadedmetadata",a),this.videoEl.load()}}exports.AutoResponsiveVideo=g;exports.ResponsiveVideo=v;
