"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const v=["mp4","webm","ogg","x-m4v","quicktime","x-ms-wmv","mpeg","3gpp","3gpp2"];function u(){return Array.from(document.querySelectorAll("video[data-responsive-video]"))}function p(s){const e=s.split("."),t=e[e.length-1];return v.includes(t)?`video/${t}`:void 0}function h(s){return s=/^\(/.test(s)?s:`(${s}`,/\)$/.test(s)?s:`${s})`}function E(){u().forEach(e=>{const t=JSON.parse(e.dataset.responsiveVideo);new l({el:e,options:t})})}class l{videoEl;options;breakpoints;isPaused;constructor({el:e,options:t}){if(!Object.keys(t).length)throw Error("No options provided to responsive-video.js");if(typeof e=="string"||e.nodeName!=="VIDEO")throw Error('Invalid "el" provided to responsive-video.js');this.videoEl=e,this.options=t,this.breakpoints=Object.keys(t),this.isPaused=this.videoEl.paused,this.init()}init(){this.videoEl.addEventListener("pause",this.pauseListener),this.videoEl.addEventListener("play",this.playListener),this.breakpoints.forEach(e=>{const t=h(e),i=window.matchMedia(t);i.matches&&this.addVideo(e),i.addEventListener("change",({matches:o})=>{o&&this.addVideo(e)})})}playListener=()=>{this.isPaused=!1};pauseListener=()=>{this.isPaused=!0};addVideo(e){const t=this.videoEl.currentTime,{src:i,poster:o}=this.options[e],c=Array.isArray(i)?[...i]:[i],n=()=>{this.videoEl.currentTime=t<this.videoEl.duration?t:0,this.isPaused===!1&&this.videoEl.play(),this.videoEl.removeEventListener("loadedmetadata",n)};o&&this.videoEl.setAttribute("poster",o),this.videoEl.querySelectorAll("source")?.forEach(d=>{d.remove()}),c.forEach(d=>{const r=document.createElement("source"),a=p(d);r.setAttribute("src",d),a?r.setAttribute("type",a):r.removeAttribute("type"),this.videoEl.appendChild(r)}),this.videoEl.addEventListener("loadedmetadata",n),this.videoEl.load()}}exports.AutoResponsiveVideo=E;exports.ResponsiveVideo=l;
