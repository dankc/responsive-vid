"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const h=["mp4","webm","ogg","x-m4v","quicktime","x-ms-wmv","mpeg","3gpp","3gpp2"];function v(){return Array.from(document.querySelectorAll("video[data-responsive-video]"))}function l(e){const t=e.split("."),s=t[t.length-1];return h.includes(s)?`video/${s}`:void 0}function m(e){return e=/^\(/.test(e)?e:`(${e}`,/\)$/.test(e)?e:`${e})`}const d=({videoEl:e,options:t,breakpoint:s})=>{const i=e.currentTime,{src:o,poster:n}=t[s],a=Array.isArray(o)?[...o]:[o],p=()=>{e.currentTime=i<e.duration?i:0,e.play(),e.removeEventListener("loadedmetadata",p)};e.pause(),n&&e.setAttribute("poster",n),e.querySelectorAll("source")?.forEach(r=>{r.remove()}),a.forEach(r=>{const c=document.createElement("source"),u=l(r);c.setAttribute("src",r),u?c.setAttribute("type",u):c.removeAttribute("type"),e.appendChild(c)}),e.addEventListener("loadedmetadata",p),e.load()};function f(){v().forEach(t=>{const s=JSON.parse(t.dataset.responsiveVideo);Object.keys(s).forEach(o=>{const n=m(o);window.matchMedia(n).matches&&d({videoEl:t,options:s,breakpoint:o}),window.matchMedia(n).addEventListener("change",({matches:a})=>{a&&d({videoEl:t,options:s,breakpoint:o})})})})}class y{videoEl;options;breakpoints;constructor({el:t,options:s}){if(!Object.keys(s).length)throw Error("No options provided to responsive-video.js");if(typeof t=="string"||t.nodeName!=="VIDEO")throw Error('Invalid "el" provided to responsive-video.js');this.videoEl=t,this.options=s,this.breakpoints=Object.keys(s),this.init()}init(){this.breakpoints.forEach(t=>{const s=m(t),i=window.matchMedia(s);i.matches&&d({videoEl:this.videoEl,options:this.options,breakpoint:t}),i.addEventListener("change",({matches:o})=>{o&&d({videoEl:this.videoEl,options:this.options,breakpoint:t})})})}}exports.AutoResponsiveVideo=f;exports.ResponsiveVideo=y;
